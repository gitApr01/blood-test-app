import React, {useState, useEffect} from 'react'
import { get, put } from '../api.js'
import { useParams, useNavigate } from 'react-router-dom'
export default function EditTest(){ const {id} = useParams(); const nav = useNavigate(); const [r,setR]=useState(null); useEffect(()=>{ async function l(){ try{ const data = await get('/all_tests'); const found = data.find(x=>String(x.id)===String(id)); setR(found); }catch(e){console.error(e)} } l() },[id]); if(!r) return <div className='card'>Loading...</div>
async function save(payload){ try{ await put(`/edit_test/${id}`, payload); nav('/tests') }catch(e){console.error(e)} }
return (<div className='card' style={{maxWidth:900}}><h2 className='h2'>Edit Test</h2><form onSubmit={e=>{e.preventDefault(); save(r)}} style={{display:'grid',gap:10}}><input className='input' value={r.patient_name} onChange={e=>setR({...r,patient_name:e.target.value})} required/><div style={{display:'flex',gap:8}}><input className='input' value={r.age} onChange={e=>setR({...r,age:e.target.value})} style={{width:120}}/><select className='input' value={r.sex} onChange={e=>setR({...r,sex:e.target.value})} style={{width:120}}><option value='M'>M</option><option value='F'>F</option></select></div><div style={{display:'flex',gap:8}}><input className='input' value={r.total} onChange={e=>setR({...r,total:e.target.value})}/><input className='input' value={r.advance} onChange={e=>setR({...r,advance:e.target.value})}/><input className='input' value={r.due} onChange={e=>setR({...r,due:e.target.value})}/></div><div style={{display:'flex',gap:8}}><input className='input' value={r.paid_to} onChange={e=>setR({...r,paid_to:e.target.value})}/><input className='input' value={r.collected_by} onChange={e=>setR({...r,collected_by:e.target.value})}/><input className='input' value={r.test_by} onChange={e=>setR({...r,test_by:e.target.value})}/></div><div style={{display:'flex',gap:8}}><button className='btn' type='button' onClick={()=>save(r)}>Save</button><button className='btn' type='button' onClick={()=>nav('/tests')}>Cancel</button></div></form></div>) }
